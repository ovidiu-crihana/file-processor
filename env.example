# ==============================
# TBD – file-processor (.env)
# Updated: 2025-10-24
# ==============================

##############
# BASE PATHS #
##############
# Percorso di lavoro (sorgenti). Accetta UNC (\\server\...) o drive mappato (W:\...).
SOURCE_BASE_PATH=\\server\Archivio\4Service\Applications\Vinci\Work
# Cartella di output radice (conterrà \tif\<n>\ e \pdf\<n>\).
OUTPUT_BASE_PATH=\\server\Archivio\4Service\Applications\Vinci\Output

# CSV
CSV_PATH=C:\\data\\ingressi\\import.csv
CSV_DELIMITER=;

###########################
# NUMERAZIONE / RAGGRUPPI #
###########################
# I gruppi di contenuto si aprono/chiudono quando cambia BATCH o TIPO_DOCUMENTO (per il TIFF/PDF aggregato).
CSV_GROUP_KEYS=BATCH,TIPO_DOCUMENTO

# La numerazione delle cartelle di output segue la coppia (BATCH, IDDOCUMENTO).
FOLDER_NUMBERING_KEYS=BATCH,IDDOCUMENTO

###########
# TAVOLE  #
###########
# Cartella base per le planimetrie (tavole) con prefisso.
TAVOLE_BASE_PATH=Work\\Tavole\\Importate
# Una riga ERRATO con TIPO_DOCUMENTO che matcha questo pattern imposta il prefisso per le righe planimetriche successive.
# Richiesto: alfanumerico o numerico con PUNTO finale (es. VIN00000911.  oppure 120.).
TAVOLE_TRIGGER_PATTERN=^[A-Za-z0-9]+\\.$
# Elenco (separato da ;) dei valori di TIPO_DOCUMENTO che identificano le planimetrie da prendere da TAVOLE_BASE_PATH con prefisso.
TAVOLE_PLANIMETRIE_VALUES=ELABORATO_GRAFICO

#####################
# NAMING DEGLI OUTPUT
#####################
# Nome file standard per TIF e PDF:
# {TIPO_PRATICA}_{PROT_PRAT_NUMERO}_{ANNO}_{TIPO_DOCUMENTO}{SUFFISSO}.{EXT}
OUTPUT_FILENAME_TEMPLATE={TIPO_PRATICA}_{PROT_PRAT_NUMERO}_{ANNO}_{TIPO_DOCUMENTO}{SUFFISSO}.{EXT}

# Suffisso opzionale quando TIPO_DOCUMENTO è esattamente "TITOLO_AUTORIZZATIVO".
# Lasciare vuoto se non si desidera il suffisso. Esempio consigliato: _TITOLO_AUTORIZZATIVO
OUTPUT_SUFFIX_TITOLO_AUTORIZZATIVO=_TITOLO_AUTORIZZATIVO

# Sanitizzazione nome file: none | basic
# basic → trim, spazi->underscore, rimozione caratteri non validi per filename Windows.
FILENAME_SANITIZE=basic

#############################
# COMPORTAMENTO & PERFORMANCE
#############################
# Cosa fare se l'output esiste già: overwrite | skip | suffix
ON_EXISTING=overwrite

# Comportamento su sorgente mancante: warn | fail
MISSING_SOURCE=warn

# Tool per merge TIFF multipagina: magick | tiffcp
# tiffcp (libtiff) è più veloce e usa meno RAM su grandi volumi.
MERGE_TOOL=tiffcp

# Compressione TIFF: group4 | lzw | zip
# Se i sorgenti sono bianco/nero, group4 è estremamente efficiente.
TIFF_COMPRESSION=group4

# Conversione PDF: magick | tiff2pdf
# tiff2pdf (libtiff) può incorporare efficientemente i TIFF multipagina.
PDF_TOOL=tiff2pdf

# Qualità PDF (se usi magick): standard | print | max
PDF_QUALITY=standard

###################
# LOG & CHECKPOINT #
###################
LOG_FILE=C:\\data\\log\\file-processor.log
CHECKPOINT_FILE=C:\\data\\state\\checkpoint.json

# Opzioni di esecuzione (suggerimenti): dry-run, resume, limit, batch, tipo
# php bin/console app:process-files --confirm --dry-run
# php bin/console app:process-files --confirm --batch=B001 --tipo=ELABORATO_GRAFICO
